<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>LoanControl â€” Clientes</title>

  <!-- Fonte -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <!-- Font Awesome (Ã­cones) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" crossorigin="anonymous"/>

  <style>
  /* ===========================
     Clientes page â€” styles
     Neutral cards; dark/light automatic
     =========================== */

  :root{
    --sidebar-w: 250px;
    --bg: #0f1724;
    --card: #121626;
    --muted: #a8b0c8;
    --text: #eef2ff;
    --accent: #0078d7;
    --glass: rgba(255,255,255,0.03);
    --radius: 12px;
    --shadow: 0 6px 18px rgba(2,6,23,0.6);
  }

  /* light overrides */
  body.light{
    --bg: #f5f7fb;
    --card: #ffffff;
    --muted: #55607a;
    --text: #0b1320;
    --accent: #1565d8;
    --glass: rgba(0,0,0,0.03);
    --shadow: 0 6px 18px rgba(16,24,40,0.06);
  }

  *{box-sizing:border-box;font-family:"Poppins",sans-serif}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--text);-webkit-font-smoothing:antialiased}

  /* Sidebar (compact copy of your app) */
  .page-wrapper{display:flex;min-height:100vh}
  .sidebar{
    width:var(--sidebar-w);
    background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent),var(--card);
    padding:18px;
    display:flex;flex-direction:column;gap:12px;
    box-shadow:var(--shadow);
  }
  .brand{display:flex;align-items:center;gap:12px}
  .brand .logo{font-size:26px}
  .brand h1{font-size:1.05rem;margin:0}
  .brand small{color:var(--muted)}
  .menu{margin-top:12px;display:flex;flex-direction:column;gap:6px}
  .menu a{display:flex;align-items:center;gap:12px;padding:10px;border-radius:10px;color:var(--text);text-decoration:none}
  .menu a:hover{background:var(--glass);color:var(--accent)}
  .menu a.active{background:var(--accent);color:#fff}
  .sidebar-footer{margin-top:auto;display:flex;flex-direction:column;gap:8px}
  .theme-toggle{background:var(--accent);color:#fff;border:none;border-radius:10px;padding:8px 12px;cursor:pointer}

  /* Main area */
  .main{
    flex:1;
    padding:20px;
    display:flex;flex-direction:column;
  }
  .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:18px}
  .topbar .left{display:flex;align-items:center;gap:12px}
  .mobile-toggle{display:none;background:transparent;border:1px solid rgba(255,255,255,0.03);padding:8px;border-radius:8px;color:var(--text)}
  .page-title h2{margin:0;font-size:1.25rem}

  /* Grid layout */
  .layout{display:grid;grid-template-columns:360px 1fr;gap:18px}
  @media (max-width:920px){
    .layout{grid-template-columns:1fr; padding-bottom:80px}
    .mobile-toggle{display:inline-flex}
    .sidebar{position:fixed;left:-100%;top:0;height:100%;z-index:50;transition:left .28s}
    .sidebar.open{left:0}
    body.sidebar-open{overflow:hidden}
  }

  /* Left column: cadastro card + filtros */
  .left-col .card, .right-col .card{background:var(--card);padding:16px;border-radius:var(--radius);box-shadow:var(--shadow)}
  .left-col .card h3{margin:0 0 12px;color:var(--accent)}

  .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .form-grid .full{grid-column:1/3}
  label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
  input[type="text"], input[type="tel"], input[type="email"], input[type="file"], select{
    width:100%;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text)
  }
  input:focus, select:focus{outline:none;border-color:var(--accent);box-shadow:0 4px 14px rgba(0,120,215,0.12)}

  .actions{display:flex;gap:8px;margin-top:12px}
  .btn{padding:10px 12px;border-radius:10px;font-weight:600;border:none;cursor:pointer}
  .btn.primary{background:var(--accent);color:#fff}
  .btn.ghost{background:transparent;color:var(--text);border:1px solid rgba(255,255,255,0.06)}
  .btn.danger{background:#e53935;color:#fff}

  /* Right column: cards of clients */
  .cards {display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px}
  .client-card{
    background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent), var(--card);
    border-radius:12px;padding:14px;position:relative;overflow:hidden;transition:transform .18s,box-shadow .18s;
    border:1px solid rgba(255,255,255,0.02);
  }
  .client-card:hover{transform:translateY(-6px);box-shadow:0 12px 30px rgba(2,6,23,0.5)}
  .client-head{display:flex;align-items:center;gap:12px}
  .avatar{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,#222,#1b2a4a);flex-shrink:0;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;overflow:hidden}
  .avatar img{width:100%;height:100%;object-fit:cover}
  .client-info{flex:1}
  .client-info h4{margin:0;font-size:1rem}
  .client-info small{color:var(--muted)}
  .client-meta{margin-top:10px;display:flex;gap:8px;flex-wrap:wrap}
  .chip{background:var(--glass);padding:6px 8px;border-radius:10px;font-size:13px;color:var(--muted)}

  .card-actions{display:flex;gap:8px;margin-top:12px;flex-wrap:wrap}
  .small-btn{padding:8px 10px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--text);cursor:pointer}
  .small-btn.whats{background:#25D366;color:#fff;border:none}
  .small-btn.history{background:transparent;color:var(--accent);border:1px solid rgba(0,120,215,0.12)}

  /* expandable details */
  .details{margin-top:12px;max-height:0;overflow:hidden;transition:max-height .3s ease;padding:0 0}
  .details.open{max-height:420px;padding-top:12px}
  .details .docs{display:flex;gap:8px;flex-wrap:wrap}
  .thumb{width:80px;height:62px;border-radius:8px;background:#0b1220;overflow:hidden;display:flex;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,0.04)}
  .thumb img{width:100%;height:100%;object-fit:cover;cursor:pointer}

  /* modal preview */
  .modal{position:fixed;inset:0;background:rgba(2,6,23,0.75);display:flex;align-items:center;justify-content:center;z-index:200;opacity:0;pointer-events:none;transition:opacity .18s}
  .modal.show{opacity:1;pointer-events:auto}
  .modal img{max-width:90vw;max-height:80vh;border-radius:10px;box-shadow:0 10px 30px rgba(0,0,0,0.6)}

  /* cpf invalid */
  .invalid{border-color:#e53935 !important}

  /* empty state */
  .empty{color:var(--muted);padding:18px;border-radius:10px;background:var(--glass);text-align:center}

  /* footer */
  .page-footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}

  .sidebar {
  transition: left .3s ease, box-shadow .3s ease;
}
.sidebar.open {
  left: 0;
  box-shadow: 0 0 0 100vw rgba(0,0,0,0.4);
}
  </style>
</head>
<body>
  <div class="page-wrapper">
    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="logo">ðŸ’¸</div>
        <div>
          <h1>LoanControl</h1>
          <small>Controle de EmprÃ©stimos</small>
        </div>
      </div>

      <nav class="menu" aria-label="Menu principal">
        <a href="index.html" class="menu-item" data-target="dashboard"><i class="fa-solid fa-gauge"></i> Dashboard</a>
        <a href="cliente.html" class="menu-item active" data-target="clientes"><i class="fa-solid fa-user"></i> Clientes</a>
        <a href="emprestimo.html" class="menu-item" data-target="emprestimos"><i class="fa-solid fa-hand-holding-dollar"></i> EmprÃ©stimos</a>
        <a href="#" class="menu-item" data-target="pagamentos"><i class="fa-solid fa-receipt"></i> Pagamentos</a>
        <a href="#" class="menu-item" data-target="calendario"><i class="fa-solid fa-calendar-days"></i> CalendÃ¡rio</a>
        <a href="#" class="menu-item" data-target="relatorios"><i class="fa-solid fa-chart-line"></i> RelatÃ³rios</a>
        <a href="#" class="menu-item" data-target="config"><i class="fa-solid fa-gear"></i> ConfiguraÃ§Ãµes</a>
      </nav>

      <div class="sidebar-footer">
        <button class="theme-toggle" id="themeToggle">ðŸŒ™ Alternar Tema</button>
        <small class="version">v1.0</small>
      </div>
    </aside>

    <!-- MAIN -->
    <main class="main" id="main">
      <div class="topbar">
        <div class="left">
          <button class="mobile-toggle" id="mobileToggle"><i class="fa-solid fa-bars"></i></button>
          <div class="page-title"><h2>Clientes</h2></div>
        </div>
        <div class="right top-actions">
          <button class="btn primary" id="newClientBtn"><i class="fa-solid fa-user-plus"></i> Novo Cliente</button>
        </div>
      </div>

      <div class="layout">
        <!-- LEFT COL -->
        <div class="left-col">
          <div class="card" id="formCard" aria-hidden="true" style="display:none;">
            <h3 id="formTitle">Cadastrar Cliente</h3>
            <form id="clientForm">
              <div class="form-grid">
                <div>
                  <label for="fullName">Nome completo</label>
                  <input id="fullName" type="text" placeholder="Nome completo" required>
                </div>
                <div>
                  <label for="phone">Telefone / WhatsApp</label>
                  <input id="phone" type="tel" placeholder="(00) 00000-0000">
                </div>
                <div>
                  <label for="cpf">CPF</label>
                  <input id="cpf" type="text" placeholder="000.000.000-00" maxlength="14">
                </div>
                <div>
                  <label for="dob">Data de cadastro</label>
                  <input id="dob" type="date" value="">
                </div>

                <div class="full">
                  <label for="address">EndereÃ§o</label>
                  <input id="address" type="text" placeholder="Rua, nÃºmero, bairro, cidade - UF">
                </div>

                <div class="full">
                  <label>Fotos (perfil / documento / comprovante)</label>
                  <div style="display:flex;gap:8px;flex-wrap:wrap">
                    <label class="btn ghost" style="display:inline-flex;align-items:center;gap:8px">
                      <i class="fa-solid fa-camera"></i> Perfil
                      <input id="fileProfile" type="file" accept="image/*" style="display:none">
                    </label>

                    <label class="btn ghost" style="display:inline-flex;align-items:center;gap:8px">
                      <i class="fa-regular fa-id-card"></i> Documento
                      <input id="fileDoc" type="file" accept="image/*" style="display:none">
                    </label>

                    <label class="btn ghost" style="display:inline-flex;align-items:center;gap:8px">
                      <i class="fa-solid fa-house"></i> Comprovante
                      <input id="fileProof" type="file" accept="image/*" style="display:none">
                    </label>
                  </div>

                  <div id="previewUploads" style="display:flex;gap:8px;margin-top:10px;flex-wrap:wrap"></div>
                </div>

              </div>

              <div class="actions">
                <button type="submit" class="btn primary" id="saveClient">Salvar</button>
                <button type="button" class="btn ghost" id="cancelClient">Cancelar</button>
              </div>
            </form>
          </div>

          <div class="card">
            <h3>Filtros</h3>
            <label>Procurar por nome</label>
            <input id="searchClient" type="text" placeholder="Pesquisar...">
            <label>Mostrar</label>
            <select id="filterStatus">
              <option value="all">Todos</option>
              <option value="withDebt">Com PendÃªncia</option>
              <option value="noDebt">Sem PendÃªncia</option>
            </select>
          </div>

          <div class="card">
            <h3>Ajuda rÃ¡pida</h3>
            <p class="empty" style="margin:0">Aqui vocÃª pode cadastrar clientes, anexar fotos dos documentos e ver aÃ§Ãµes rÃ¡pidas (editar, histÃ³rico, WhatsApp).</p>
          </div>
        </div>

        <!-- RIGHT COL -->
        <div class="right-col">
          <div class="card">
            <h3>Clientes</h3>
            <div id="cardsContainer" class="cards">
              <!-- Client cards are injected here by JS (see below) -->
              <div class="empty">Nenhum cliente â€” clique em "Novo Cliente" para cadastrar</div>
            </div>
          </div>

          <div class="card">
            <h3>Visualizar em lista</h3>
            <div id="listContainer" class="table-placeholder">Tabela de clientes (vazia)</div>
          </div>

          <div class="page-footer">Â© LoanControl â€” Clientes</div>
        </div>
      </div>

      <!-- image modal -->
      <div id="imgModal" class="modal" aria-hidden="true">
        <img src="" alt="Preview" id="modalImg">
      </div>
    </main>
  </div>

  <script>
  /* =========================
     UI-only JS for Clientes page
     - Handles UI, previews, card expand/collapse
     - Does NOT persist data. Use this as hook for your main.js
     ========================= */

  (function(){
    // Helpers
    const $ = (sel, ctx=document) => ctx.querySelector(sel);
    const $$ = (sel, ctx=document) => Array.from(ctx.querySelectorAll(sel));

    // Elements
    const sidebar = document.getElementById('sidebar');
    const mobileToggle = document.getElementById('mobileToggle');
    const newClientBtn = document.getElementById('newClientBtn');
    const formCard = document.getElementById('formCard');
    const clientForm = document.getElementById('clientForm');
    const cancelClient = document.getElementById('cancelClient');
    const previewUploads = document.getElementById('previewUploads');
    const fileProfile = document.getElementById('fileProfile');
    const fileDoc = document.getElementById('fileDoc');
    const fileProof = document.getElementById('fileProof');
    const cardsContainer = document.getElementById('cardsContainer');
    const imgModal = document.getElementById('imgModal');
    const modalImg = document.getElementById('modalImg');
    const themeToggle = document.getElementById('themeToggle');
    const searchClient = document.getElementById('searchClient');

    // Temporary in-memory list (UI demo). Replace with your storage later.
    let clients = [];

    // Theme: auto from localStorage
    const THEME_KEY = 'loanTheme';
    (function applySavedTheme(){
      const t = localStorage.getItem(THEME_KEY) || 'dark';
      if(t === 'light') document.body.classList.add('light');
      else document.body.classList.remove('light');
    })();
    themeToggle.addEventListener('click', () => {
      const isLight = document.body.classList.toggle('light');
      localStorage.setItem(THEME_KEY, isLight ? 'light' : 'dark');
    });

    // Mobile sidebar toggle
    mobileToggle.addEventListener('click', () => {
      sidebar.classList.toggle('open');
      document.body.classList.toggle('sidebar-open');
    });

    // Show form
    newClientBtn.addEventListener('click', () => {
      formCard.style.display = 'block';
      formCard.scrollIntoView({behavior:'smooth'});
      document.getElementById('formTitle').textContent = 'Cadastrar Cliente';
      clientForm.reset();
      previewUploads.innerHTML = '';
      editingIndex = -1;
    });

    cancelClient.addEventListener('click', () => {
      formCard.style.display = 'none';
      clientForm.reset();
      previewUploads.innerHTML = '';
    });

    // file inputs previews
    function previewFile(inputEl, slotName){
      const file = inputEl.files[0];
      if(!file) return;
      const reader = new FileReader();
      reader.onload = e => {
        // create thumb
        const div = document.createElement('div');
        div.className = 'thumb';
        div.dataset.slot = slotName;
        div.innerHTML = `<img src="${e.target.result}" alt="${slotName}">`;
        div.addEventListener('click', () => openPreview(e.target.result));
        // replace previous same slot
        const existing = previewUploads.querySelector(`[data-slot="${slotName}"]`);
        if(existing) existing.remove();
        previewUploads.appendChild(div);
      };
      reader.readAsDataURL(file);
    }

    fileProfile.addEventListener('change', () => previewFile(fileProfile, 'profile'));
    fileDoc.addEventListener('change', () => previewFile(fileDoc, 'doc'));
    fileProof.addEventListener('change', () => previewFile(fileProof, 'proof'));

    function openPreview(src){
      modalImg.src = src;
      imgModal.classList.add('show');
      imgModal.setAttribute('aria-hidden','false');
    }
    imgModal.addEventListener('click', (e) => {
      if(e.target === imgModal || e.target === modalImg){
        imgModal.classList.remove('show');
        imgModal.setAttribute('aria-hidden','true');
      }
    });

    
    // Rendering clients (UI only). Hook this to your data later.
    function renderClients(list){
      cardsContainer.innerHTML = '';
      if(!list || list.length===0){
        cardsContainer.innerHTML = '<div class="empty">Nenhum cliente â€” clique em "Novo Cliente" para cadastrar</div>';
        return;
      }
      list.forEach((c, idx) => {
        const card = document.createElement('article');
        card.className = 'client-card';
        card.innerHTML = `
          <div class="client-head">
            <div class="avatar">${c.profile ? `<img src="${c.profile}" alt="${c.name}">` : c.name.split(' ').slice(0,2).map(x=>x[0]).join('')}</div>
            <div class="client-info">
              <h4>${c.name}</h4>
              <small>${c.cpf || 'â€”'} â€¢ ${c.phone || 'â€”'}</small>
              <div class="client-meta">
                <span class="chip">Cadastrado: ${c.date || 'â€”'}</span>
                <span class="chip">Cidade: ${c.city || 'â€”'}</span>
              </div>
            </div>
            <div style="margin-left:12px;text-align:right">
              <button class="small-btn history" data-idx="${idx}"><i class="fa-solid fa-clock-rotate-left"></i> Hist.</button>
              <button class="small-btn" data-idx="${idx}" id="toggle${idx}"><i class="fa-solid fa-angle-down"></i></button>
            </div>
          </div>

          <div class="details" id="details${idx}">
            <div style="display:flex;justify-content:space-between;gap:12px;align-items:flex-start">
              <div style="flex:1">
                <p><strong>EndereÃ§o:</strong> ${c.address || 'â€”'}</p>
                <p><strong>ObservaÃ§Ãµes:</strong> ${c.notes || 'â€”'}</p>
              </div>
              <div style="width:220px">
                <div class="docs">
                  ${c.profile ? `<div class="thumb"><img src="${c.profile}" alt="perfil"></div>` : ''}
                  ${c.doc ? `<div class="thumb"><img src="${c.doc}" alt="doc"></div>` : ''}
                  ${c.proof ? `<div class="thumb"><img src="${c.proof}" alt="proof"></div>` : ''}
                </div>
              </div>
            </div>

            <div class="card-actions">
              <button class="small-btn" data-action="edit" data-idx="${idx}"><i class="fa-solid fa-pen"></i> Editar</button>
              <button class="small-btn danger" data-action="delete" data-idx="${idx}"><i class="fa-solid fa-trash"></i> Excluir</button>
              <button class="small-btn history" data-action="history" data-idx="${idx}"><i class="fa-solid fa-eye"></i> Ver HistÃ³rico</button>
              <button class="small-btn whats" data-action="whats" data-idx="${idx}"><i class="fa-brands fa-whatsapp"></i> WhatsApp</button>
              <button class="small-btn primary" data-action="solicitar" data-idx="${idx}">
              <i class="fa-solid fa-hand-holding-dollar"></i> Solicitar
              </button>
            </div>
          </div>
        `;
        cardsContainer.appendChild(card);

        // toggle expand
        const toggleBtn = card.querySelector(`#toggle${idx}`);
        const details = card.querySelector(`#details${idx}`);
        toggleBtn && toggleBtn.addEventListener('click', () => {
          details.classList.toggle('open');
        });

        // actions (event delegation)
        card.addEventListener('click', (ev) => {
          const target = ev.target.closest('[data-action]') || ev.target.closest('[data-idx]');
          if(!target) return;
          const action = target.dataset.action;
          const idx = parseInt(target.dataset.idx,10);
          if(action === 'delete') {
            if(confirm('Excluir cliente?')) {
              clients.splice(idx,1);
              renderClients(clients);
            }
          } else if(action === 'edit') {
            openEditClient(idx);
          } else if(action === 'whats') {
            const c = clients[idx];
            if(c.phone){
              const msg = encodeURIComponent(`OlÃ¡ ${c.name}, estamos entrando em contato sobre seu emprÃ©stimo.`);
              window.open(`https://wa.me/${c.phone.replace(/\D/g,'')}?text=${msg}`, '_blank');
            } else alert('Cliente sem telefone cadastrado.');
          } else if(action === 'history'){
            alert('Abrir histÃ³rico de emprÃ©stimos (hook para implementar).');
          }
            else if (action === 'solicitar') {
            const c = clients[idx];
            localStorage.setItem('emprestimoCliente', JSON.stringify({
            nome: c.name,
            telefone: c.phone
          }));
          
  window.location.href = 'emprestimo.html';
}
        });

        // thumbnails click to open modal
        const thumbs = card.querySelectorAll('.thumb img');
        thumbs.forEach(img => img.addEventListener('click', (e) => openPreview(e.target.src)));
      });
    }

    // stub: open edit
    function openEditClient(idx){
      const c = clients[idx];
      if(!c) return;
      formCard.style.display = 'block';
      document.getElementById('formTitle').textContent = 'Editar Cliente';
      document.getElementById('fullName').value = c.name || '';
      document.getElementById('phone').value = c.phone || '';
      document.getElementById('cpf').value = c.cpf || '';
      document.getElementById('dob').value = c.date || '';
      document.getElementById('address').value = c.address || '';
      previewUploads.innerHTML = '';
      if(c.profile) previewUploads.appendChild(createThumb(c.profile,'profile'));
      if(c.doc) previewUploads.appendChild(createThumb(c.doc,'doc'));
      if(c.proof) previewUploads.appendChild(createThumb(c.proof,'proof'));
      editingIndex = idx;
    }

    function createThumb(src,slot){
      const div = document.createElement('div');
      div.className = 'thumb';
      div.dataset.slot = slot;
      div.innerHTML = `<img src="${src}" alt="${slot}">`;
      div.addEventListener('click',()=>openPreview(src));
      return div;
    }

    // submit (UI only)
    let editingIndex = -1;
    clientForm.addEventListener('submit', (e) => {
      e.preventDefault();
      // gather
      const name = document.getElementById('fullName').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const cpf = document.getElementById('cpf').value.trim();
      const date = document.getElementById('dob').value;
      const address = document.getElementById('address').value.trim();

      // cpf validate
      if(!validaCPF(cpf)){
        const cpfEl = document.getElementById('cpf');
        cpfEl.classList.add('invalid');
        alert('CPF invÃ¡lido. Verifique e tente novamente.');
        return;
      } else {
        document.getElementById('cpf').classList.remove('invalid');
      }

      // read previews for images (if any)
      const profileThumb = previewUploads.querySelector('[data-slot="profile"] img');
      const docThumb = previewUploads.querySelector('[data-slot="doc"] img');
      const proofThumb = previewUploads.querySelector('[data-slot="proof"] img');

      const clientObj = {
        name,
        phone,
        cpf,
        date,
        address,
        profile: profileThumb ? profileThumb.src : null,
        doc: docThumb ? docThumb.src : null,
        proof: proofThumb ? proofThumb.src : null,
        notes: ''
      };

      if(editingIndex >=0){
        clients[editingIndex] = clientObj;
        editingIndex = -1;
      } else {
        clients.unshift(clientObj); // add to start
      }

      renderClients(clients);
      clientForm.reset();
      previewUploads.innerHTML = '';
      formCard.style.display = 'none';
    });

    // Create thumb helper exposed earlier
    function createFromInput(fileInput, slot){
      const f = fileInput.files[0];
      if(!f) return;
      const reader = new FileReader();
      reader.onload = e => {
        const div = createThumb(e.target.result, slot);
        // replace existing
        const existing = previewUploads.querySelector(`[data-slot="${slot}"]`);
        if(existing) existing.remove();
        previewUploads.appendChild(div);
      };
      reader.readAsDataURL(f);
    }
    // wire hidden file inputs to visible labels
    // labels already wrap input; no further wiring needed, but listen changes:
    fileProfile.addEventListener('change', ()=> createFromInput(fileProfile,'profile'));
    fileDoc.addEventListener('change', ()=> createFromInput(fileDoc,'doc'));
    fileProof.addEventListener('change', ()=> createFromInput(fileProof,'proof'));

    // search filter (simple)
    searchClient.addEventListener('input', (e) => {
      const q = e.target.value.trim().toLowerCase();
      if(!q) return renderClients(clients);
      const filtered = clients.filter(c => (c.name||'').toLowerCase().includes(q) || (c.cpf||'').includes(q));
      renderClients(filtered);
    });

    // CPF validator function (same as above in utils)
    function validaCPF(cpf){
      if(!cpf) return true;
      const only = cpf.replace(/\D/g,'');
      if(only.length !== 11) return false;
      if(/^(\d)\1+$/.test(only)) return false;
      const nums = only.split('').map(n=>parseInt(n,10));
      let sum=0;
      for(let i=0;i<9;i++) sum += nums[i]*(10-i);
      let rev = 11 - (sum % 11);
      if(rev===10||rev===11) rev=0;
      if(rev !== nums[9]) return false;
      sum=0;
      for(let i=0;i<10;i++) sum += nums[i]*(11-i);
      rev = 11 - (sum % 11);
      if(rev===10||rev===11) rev=0;
      return rev === nums[10];
    }

    // initial render (demo data)
    clients = [
      {
        name: 'Mariana Silva',
        phone: '+5592999551234',
        cpf: '12345678909',
        date: '2025-01-12',
        address: 'Rua das Flores, 123, Centro - AM',
        profile: null,
        doc: null,
        proof: null,
        notes: 'Cliente vip'
      },
      {
        name: 'JoÃ£o Pereira',
        phone: '',
        cpf: '',
        date: '2025-02-03',
        address: 'Av. Brasil, 45 - SP',
        profile: null,
        doc: null,
        proof: null,
        notes: ''
      }
    ];
    renderClients(clients);

    // expose hooks for later integration
    window._clientsUI = {
      renderClients,
      getClients: ()=>clients,
      setClients: (arr)=>{clients = arr; renderClients(clients)}
    };

    // Fecha menu lateral ao clicar em um item ou fora (modo mobile)
document.addEventListener('click', (e) => {
  if (window.innerWidth <= 920) {
    if (!sidebar.contains(e.target) && !mobileToggle.contains(e.target)) {
      sidebar.classList.remove('open');
      document.body.classList.remove('sidebar-open');
    }
  }
});

$$('.menu a').forEach(a => a.addEventListener('click', () => {
  sidebar.classList.remove('open');
  document.body.classList.remove('sidebar-open');
}));
  })();
  </script>
</body>
</html>
2